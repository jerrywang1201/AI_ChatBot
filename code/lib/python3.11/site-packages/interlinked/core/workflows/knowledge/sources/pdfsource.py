import io
from typing import Any

from interlinked.core.ai import Section


class PDFSource:

    @classmethod
    def get_section_for_pdf(cls, filename: str, file: bytes) -> Section:
        """
        Reads a pdf document and returns a nested `Section`
        """

        from unstructured.partition.pdf import partition_pdf

        section: Section = Section(title=filename)
        file_io: io.BytesIO = io.BytesIO(file)
        elements: list[Any] = partition_pdf(file=file_io, chunking_strategy="by_title")

        for element in elements:

            subsection: Section = Section(content=[str(element)])
            section.append_subsection(subsection=subsection)

        return section
