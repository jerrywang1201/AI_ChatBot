import os
import sys
import logging


def setup_logging():

	# conditionally print colors if the console/terminal supports it
	supports_color: bool = sys.stdout.isatty() and not os.getenv('NO_COLOR')

	logger = logging.getLogger('interlinked')
	logger.setLevel(logging.INFO)
	logger.propagate = False

	if not logger.hasHandlers():

		handler = logging.StreamHandler()
		handler.setLevel(logging.INFO)

		# reset color
		format_: str = '\033[0m' if supports_color else ''
		formatter = logging.Formatter(f'{format_}%(asctime)s[%(levelname).1s][%(funcName)s] %(message)s''', datefmt='%-I:%M:%S%p')

		handler.setFormatter(formatter)
		logger.addHandler(handler)

	logging.SECTION: int = logging.INFO + 1
	logging.addLevelName(logging.SECTION, 'SECTION')

	def section(self, message: str, *args, **kwargs):
		self.log(logging.SECTION, f'\33[1m\33[92m➡️  {message}\033[0m' if supports_color else f'➡️  {message}', *args, **kwargs)

	def info(self, message: str, *args, **kwargs):
		self.log(logging.INFO, f'\033[96m{message}\033[0m' if supports_color else message, *args, **kwargs)

	def error(self, message: str, *args, **kwargs):
		self.log(logging.ERROR, f'\033[91m{message}\033[0m' if supports_color else message, *args, **kwargs)

	def warning(self, message: str, *args, **kwargs):
		self.log(logging.WARNING, f'\033[33m{message}\033[0m' if supports_color else message, *args, **kwargs)

	logging.Logger.info = info
	logging.Logger.error = error
	logging.Logger.warning = warning
	logging.Logger.section = section



setup_logging()