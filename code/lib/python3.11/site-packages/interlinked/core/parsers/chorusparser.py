import re
from bs4 import BeautifulSoup, Tag

from interlinked.core.ai import Section
from interlinked.core.parsers.htmlparser import HTMLParser
from interlinked.core.parsers.imageparser import ImageParser


class ChorusParser:
	"""
	Converts Chorus pages to `Section` to use with `AI.learn(…)`
	"""

	@classmethod
	def get_section_for_html(cls, content: str) -> Section:
		"""
		Parses HTML then returns a `Section`

        @param content(str): The HTML from a Chorus page (from `ChorusClient(…).get_page(…).html`)		
		"""

		beautiful_soup: BeautifulSoup = BeautifulSoup(content, 'html.parser')

		for tag in beautiful_soup.find_all(class_=['layout-section', 'layout-column']):
			tag.unwrap()

		return HTMLParser.get_section_for_html(content=str(beautiful_soup))


if __name__ == '__main__':

	from interlinked.core.clients.chorusclient import ChorusClient
	print(ChorusParser.get_section_for_html(content=ChorusClient.shared.get_page(id=7273508).html))