from typing import Any

from interlinked.core.ai import AI, Section
from interlinked.core.clients.ollamaclient import OllamaClient

TEMPLATE: str =  \
'''Your task is to describe the image and respond in the exact format below:
Title<!type:string,required:true!>: A short title that would best-describe the image
Description<!type:string,required:true!>: A detailed description of the image'''


class ImageParser:
	"""
	Converts an image to `Section`
	"""

	@classmethod
	def get_section_for_image(cls, content: bytes, client: Any = None) -> Section:
		"""
		Asks AI to describe a given image then returns a `Section`
		"""

		# "For additional context, the image is part of a document called ""
		observation: Observation = AI.ask(template=TEMPLATE, files=[content], client=client)
		return Section(title=observation.title, content=[observation.description])


if __name__ == '__main__':
	print(ImageParser.get_section_for_image(content='../../../examples/file_examples/seal.jpg', client=OllamaClient(model_name='llava:v1.6')))